version: 2.1

executors:
  cimg-base:
    docker:
      - image: cimg/base:stable

parameters:
  check-workflow-status:
    type: boolean
    default: false
  build-ios:
    type: boolean
    default: false
  build-android:
    type: boolean
    default: false

jobs:
  workflow-status-check:
    docker:
      - image: cimg/python:3.10.7
    steps:
      - checkout
      - run: pip install -r requirements.txt
      - run: python .circleci/check-workflow-status.py <<pipeline.git.revision>>
  ios-ci:
    executor: cimg-base
    steps:
      - checkout
      - run: echo "iOS"
  android-ci:
    executor: cimg-base
    steps:
      - checkout
      - run: echo "Android"
workflows:
  workflow-status-checks-workflow:
    when: << pipeline.parameters.check-workflow-status >>
    jobs:
      - workflow-status-check
  ios-workflow:
    when: << pipeline.parameters.build-ios >>
    jobs:
      - ios-ci
  android-workflow:
    when: << pipeline.parameters.build-android >>
    jobs:
      - android-ci